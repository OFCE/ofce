---
title: "Charte graphique"
vignette: >
  %\VignetteIndexEntry{Charte graphique}
  %\VignetteEngine{quarto::html}
  %\VignetteEncoding{UTF-8}
echo: true
message: false
warning: false
format:
  html:
    code-fold: true
    code-summary: "code"
---

L'utilisation de `R` permet l'intégration directe de la charte graphique de l'OFCE directement dans la rédaction du code, que ce soit pour la production de graphiques, ou celle de tables. Cela passe par la définition d'un thème qui en reprends les différents élements et qui est ensuite associé à l'objet `ggplot2` ou `gt`.

```{r setup, include=FALSE}
ofce::init_qmd()
```

## Pour les graphiques (ggplot2)

Un graphique ggplot2 par défaut aura le rendu suivant:

```{r, echo = TRUE}
p <- ggplot(iris) + 
  aes(x = Sepal.Width, y = Sepal.Length, group = Species, color = Species) +
  geom_point(size = 2)

p
```

L'ajout de la commande `theme_{nomdutheme}` permet d'appliquer un thème spécifique au graphe produit (ici `theme_classic`). Plusieurs sont déjà pré-enregistrés dans ggplot2.

```{r, echo = TRUE}

p + theme_classic()
```

Un thème spécifique à l'OFCE existe dans le package ofce et permet d'appliquer des modifications de forme qui reprenne les élements de la charte graphique définie par ailleurs.

```{r, echo = TRUE}

p + ofce::theme_ofce()
```

## Palettes de couleur

Il est également possible de spécifier manuellement les couleurs dans un graphe à l'aide de la commande `scale_XXX_manual` [^1], en y associant un vecteur de couleur.

[^1]: selon le type de `geom` XXX sera soit un `color` (pour `geom_point` et `geom_line`) soit `fill` (pour les graphiques avec des zones à remplir comme `geom_area`).

```{r, echo = TRUE}

p + 
  ofce::theme_ofce() + 
  scale_color_manual(values = c("darkred", "darkblue", "darkgreen"))

```

### Palettes de couleur OFCE

Les palettes de couleur OFCE peuvent être directement chargées depuis le package à l'aide de la commande `load`. Trois palettes sont actuellements enregistrées:

-   `palette_pays`: couleurs associées à une sélection large de pays (pour certains deux couleurs sont possibles, le choix résultant de son accord avec les autres)
-   `palette_principale`: couleurs principales utilisées à l'OFCE
-   `palette_degrades`: Palettes réduites pour des degradés autour de certaines couleurs (entre 3 et 6 couleurs)

Elles sont également intégrées à des fonctions du package ofce qui permettent d'avoir un vecteur de couleurs directement en fonction d'un nombre pour `ofce_palette` et d'un vecteur de code `iso3` pour les pays pour `ofce_palette_pays`.

```{r, echo = TRUE}

p + 
  ofce::theme_ofce() + 
  scale_color_manual(values = ofce::ofce_palette(n=3))

```


Pour le choix des couleurs de pays, il est également possible de passer par une fonction de type `scale_manual` dans le package `ofce` `scale_color_pays` qui intègre directement l'application des codes couleurs de la charte graphique en plus d'offrir des options supplémentaires en termes de labelling.

Note: Il est essentiel à ce qu'il existe une colonne dans le dataframe qui contiennent les codes pays au format [*ISO 3166-1 alpha-3*](https://www.iban.com/country-codes).

```{r, echo = TRUE}

vec_iso <- c("ESP", "DEU", "FRA")
data <- data.frame("value" = c(1:30), 
                    "iso" = vec_iso) |> 
  arrange(iso) |> 
  mutate(date = c(2011:2020, 2011:2020, 2011:2020))


data |> 
  ggplot()  +
  geom_line(aes(x= date, y = value, color = iso )) +
  ofce::scale_color_pays(vec_iso,
                   lang = "en") +
  ofce::theme_ofce()


```

## Documentation Charte Graphique

Les références de code couleurs peuvent être consultés dans les documents suivants:

###  Pour les pays
![](images/TableCoul_Pays_OFCE2024-juin.pdf){width="990" height="740"}

###  Pour les palettes principales
x![](images/Couleurs_Graphes_2024-juin.pdf){width="990" height="740"}

<!-- ## Tableaux  -->

<!-- ```{r} -->

<!-- ofce::theme.gt_ofce() -->

<!-- ``` -->
